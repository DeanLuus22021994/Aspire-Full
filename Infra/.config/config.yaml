version: 1

environment:
  dotnet:
    sdk: "10.0.100"
    preview: true
  python:
    version: "3.15.0"
    manager: "uv"
    torch:
      device: "cuda"
  hardware:
    gpu:
      enabled: true

contexts:
  python:
    lint:
      line_length: 100

      vendor_globs: &vendor_globs
        - .vscode
        - .vscode/**
        - .vscode-test
        - .vscode-test/**
        - .vscode-*
        - .vscode-*/**
        - node_modules
        - node_modules/**

      paths:
        lint_roots: &lint_roots
          - Aspire-Full.Python/python-agents
          - sandboxes
          - scripts
          - tools
        exclude_globs: *vendor_globs

      flake8:
        extend_ignore: &flake8_ignore
          - E203
          - W503
        exclude: *vendor_globs

      pycodestyle:
        ignore: *flake8_ignore

      pylint:
        disable: &pylint_disable
          - missing-docstring
          - invalid-name
        ignore:
          - .vscode
          - .vscode/extensions
          - .vscode-test
          - .vscode-debug
          - .vscode-extensions
        ignore_paths: &pylint_vendor_regex
          - '.*\\/\\.vscode\\/.*'
          - '.*\\\\\\.vscode\\\\.*'
          - '.*\\/\\.vscode-test\\/.*'
          - '.*\\\\\\.vscode-test\\\\.*'
          - '.*\\/\\.vscode-.*'
          - '.*\\\\\\.vscode-.*'
        ignore_patterns: *pylint_vendor_regex

      pyright:
        exclude: *vendor_globs
        extra_paths:
          - Aspire-Full.Python/python-agents/src
        venv_path: Aspire-Full.Python/python-agents
        venv: .venv

      runner:
        auto_targets: *lint_roots
        pylint_disable: *pylint_disable

    test:
      vendor_globs: *vendor_globs

      paths:
        test_roots: &test_roots
          - Aspire-Full.Python/python-agents/tests
          - sandboxes
          - scripts/tests
        exclude_globs: *vendor_globs

      pytest:
        addopts: &pytest_addopts
          - -q
        markers:
          - "slow: marks tests as slow"
          - "gpu: requires NVIDIA GPU"
        filterwarnings:
          - ignore::DeprecationWarning

      runner:
        auto_targets: *test_roots
        default_addopts: *pytest_addopts

telemetry:
  gpu:
    spec_file: .config/gpu-utilization.yaml
    snapshot:
      measured_utilization: 0.30
      target_utilization: 0.80
      relative_to_target_pct: 37.5
      utilization_gap: 0.50
    intent:
      mode: maintenance
      implementation_ready: true
      description: "Accelerated computations for package maintenance and high throughput."
    propagation_refs:
      connectors:
        tags:
          - connector.metric.gpu_only
      scripts:
        - scripts/Start-Aspire.ps1
        - scripts/run-tests.ps1
      docs:
        - README.md
    notes:
      - "Actual utilization is calculated from live tensor computation workloads (not pinned)."
      - "Gap highlights the 30% actual vs 80% optimized expectation."
