{
  "name": "Aspire-Full Lightweight",
  "build": {
    "dockerfile": "Dockerfile",
    "context": ".."
  },

  "features": {
    "ghcr.io/devcontainers/features/docker-in-docker:2": {
      "version": "latest",
      "moby": true,
      "dockerDashComposeVersion": "v2"
    }
  },

  "customizations": {
    "vscode": {
      "extensions": ["ms-dotnettools.csharp", "ms-dotnettools.csdevkit", "GitHub.copilot", "GitHub.copilot-chat"],
      "settings": {
        "dotnet.defaultSolution": "Aspire-Full.slnx",
        "editor.formatOnSave": true,
        "files.exclude": {
          "**/bin": true,
          "**/obj": true,
          "**/artifacts": true
        }
      }
    }
  },

  "forwardPorts": [5000, 5001, 5173, 5432, 6379, 6333, 18888],
  "portsAttributes": {
    "5000": { "label": "API", "onAutoForward": "notify" },
    "5001": { "label": "Gateway", "onAutoForward": "notify" },
    "5173": { "label": "Frontend", "onAutoForward": "notify" },
    "5432": { "label": "PostgreSQL", "onAutoForward": "silent" },
    "6379": { "label": "Redis", "onAutoForward": "silent" },
    "6333": { "label": "Qdrant", "onAutoForward": "silent" },
    "18888": { "label": "Aspire Dashboard", "onAutoForward": "notify" }
  },

  "postCreateCommand": "dotnet restore && dotnet build",
  "postStartCommand": "echo 'DevContainer ready. Run: dotnet run --project Infra/Aspire-Full'",

  "remoteEnv": {
    "ASPIRE_ALLOW_UNSECURED_TRANSPORT": "true",
    "DOTNET_ENVIRONMENT": "Development"
  },

  "containerEnv": {
    "DOTNET_CLI_TELEMETRY_OPTOUT": "1",
    "DOTNET_NOLOGO": "1"
  }
}
